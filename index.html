<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>杭烟卷包车间A线"聚力攻坚 提质达效"劳动竞赛</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <script>
    (function(){
        var APP_VERSION = 'b35c2a6';
        try {
            var url = new URL(window.location.href);
            if (url.searchParams.get('v') !== APP_VERSION) {
                url.searchParams.set('v', APP_VERSION);
                window.location.replace(url.toString());
            }
        } catch(e) {}
    })();
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 5px;
            backdrop-filter: blur(10px);
        }

        .tab {
            padding: 12px 24px;
            margin: 0 5px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        .tab.active {
            background: rgba(255,255,255,0.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .tab:hover {
            background: rgba(255,255,255,0.15);
        }

        .content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .ranking-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
        }

        .ranking-table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s ease;
        }

        .ranking-table tr:hover {
            background-color: #f8f9fa;
        }

        .ranking-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .rank-1 { color: #ffd700; font-weight: bold; }
        .rank-2 { color: #c0c0c0; font-weight: bold; }
        .rank-3 { color: #cd7f32; font-weight: bold; }
        
        /* 为前四名添加浅蓝色底色 */
        .ranking-table tbody tr:nth-child(1) {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
        }
        .ranking-table tbody tr:nth-child(2) {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
        }
        .ranking-table tbody tr:nth-child(3) {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
        }
        .ranking-table tbody tr:nth-child(4) {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
        }

        .score-high { color: #27ae60; font-weight: bold; }
        .score-medium { color: #f39c12; font-weight: bold; }
        .score-low { color: #e74c3c; font-weight: bold; }

        .insufficient { color: #95a5a6; font-style: italic; }


        .date-selector {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-start;
        }

        .selector-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 200px;
        }

        .selector-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .selector-group select {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .date-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* 移动端优化 */
        @media (max-width: 768px) {
            .date-selector {
                flex-direction: column;
                gap: 15px;
            }
            
            .selector-group {
                min-width: auto;
            }
            
            .selector-group label {
                font-size: 0.9rem;
                margin-bottom: 6px;
            }
            
            .selector-group select {
                padding: 14px 15px;
                font-size: 1.1rem;
            }
        }

        /* 超小屏幕优化 */
        @media (max-width: 480px) {
            .date-selector {
                margin-bottom: 15px;
                gap: 12px;
            }
            
            .selector-group select {
                padding: 12px 15px;
                font-size: 1rem;
            }
            
            .selector-group label {
                font-size: 0.85rem;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                margin: 5px;
                padding: 10px 16px;
            }
            
            .ranking-table {
                font-size: 0.9rem;
            }
            
            .ranking-table th,
            .ranking-table td {
                padding: 8px 10px;
            }
        }
    </style>



































<script>
(function(){
    try {
        var APP_VERSION = (window.competitionData && window.competitionData.last_updated) || '';
        if (!APP_VERSION) return;
        var url = new URL(window.location.href);
        if (url.searchParams.get('v') !== APP_VERSION) {
            url.searchParams.set('v', APP_VERSION);
            window.location.replace(url.toString());
        }
    } catch(e) {}
})();
</script>





<script>window.competitionData = {
  "total_rankings": [
    {
      "机号": "A05",
      "班次": "乙班",
      "总积分": 35,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 155.8,
      "排名": 3,
      "日均积分": 4.38
    },
    {
      "机号": "A03",
      "班次": "乙班",
      "总积分": 34,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 153.6,
      "排名": 4,
      "日均积分": 4.25
    },
    {
      "机号": "A04",
      "班次": "乙班",
      "总积分": 31,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 157.6,
      "排名": 5,
      "日均积分": 3.88
    },
    {
      "机号": "A01",
      "班次": "乙班",
      "总积分": 27,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 148.9,
      "排名": 8,
      "日均积分": 3.38
    },
    {
      "机号": "A09",
      "班次": "乙班",
      "总积分": 18,
      "有效天数": 9,
      "否样次数": 0,
      "日均产量": 35.7,
      "排名": 10,
      "日均积分": 2.0
    },
    {
      "机号": "A02",
      "班次": "乙班",
      "总积分": 15,
      "有效天数": 9,
      "否样次数": 0,
      "日均产量": 148.5,
      "排名": 11,
      "日均积分": 1.67
    },
    {
      "机号": "A03",
      "班次": "甲班",
      "总积分": 36,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 156.4,
      "排名": 1,
      "日均积分": 4.5
    },
    {
      "机号": "A05",
      "班次": "甲班",
      "总积分": 35,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 159.1,
      "排名": 2,
      "日均积分": 4.38
    },
    {
      "机号": "A01",
      "班次": "甲班",
      "总积分": 31,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 152.8,
      "排名": 6,
      "日均积分": 3.88
    },
    {
      "机号": "A04",
      "班次": "甲班",
      "总积分": 30,
      "有效天数": 8,
      "否样次数": 0,
      "日均产量": 151.1,
      "排名": 7,
      "日均积分": 3.75
    },
    {
      "机号": "A09",
      "班次": "甲班",
      "总积分": 22,
      "有效天数": 9,
      "否样次数": 0,
      "日均产量": 37.4,
      "排名": 9,
      "日均积分": 2.44
    },
    {
      "机号": "A02",
      "班次": "甲班",
      "总积分": 9,
      "有效天数": 9,
      "否样次数": 0,
      "日均产量": 137.0,
      "排名": 12,
      "日均积分": 1.0
    }
  ],
  "daily_rankings": [
    {
      "机号": "A01",
      "产量": 163.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A01",
      "产量": 153.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A03",
      "产量": 152.4,
      "积分": 1,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A05",
      "产量": 113.6,
      "积分": 0,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A02",
      "产量": 112.4,
      "积分": 0,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A03",
      "产量": 110.6,
      "积分": 0,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A05",
      "产量": 134.8,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.1
    },
    {
      "机号": "A02",
      "产量": 127.4,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.1
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A09",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A09",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A05",
      "产量": 169.4,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.2
    },
    {
      "机号": "A05",
      "产量": 159.1,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.2
    },
    {
      "机号": "A01",
      "产量": 155.2,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.2
    },
    {
      "机号": "A03",
      "产量": 151.2,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.2
    },
    {
      "机号": "A03",
      "产量": 153.6,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.2
    },
    {
      "机号": "A01",
      "产量": 149.6,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.2
    },
    {
      "机号": "A04",
      "产量": 150.9,
      "积分": 1,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.2
    },
    {
      "机号": "A09",
      "产量": 40.6,
      "积分": 1,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.2
    },
    {
      "机号": "A02",
      "产量": 151.8,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.2
    },
    {
      "机号": "A04",
      "产量": 145.6,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.2
    },
    {
      "机号": "A02",
      "产量": 130.4,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.2
    },
    {
      "机号": "A09",
      "产量": 26,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.2
    },
    {
      "机号": "A03",
      "产量": 164.6,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A04",
      "产量": 163.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A01",
      "产量": 157.6,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A03",
      "产量": 152.6,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A04",
      "产量": 143.5,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A09",
      "产量": 43.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.3
    },
    {
      "机号": "A01",
      "产量": 152.6,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.3
    },
    {
      "机号": "A09",
      "产量": 36.8,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.3
    },
    {
      "机号": "A02",
      "产量": 126.2,
      "积分": 0,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.3
    },
    {
      "机号": "A02",
      "产量": 158.8,
      "积分": 1,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.3
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.3
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.3
    },
    {
      "机号": "A05",
      "产量": 170.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A03",
      "产量": 163.4,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A04",
      "产量": 163,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A05",
      "产量": 162.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A03",
      "产量": 154,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A04",
      "产量": 153.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A01",
      "产量": 147.9,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.4
    },
    {
      "机号": "A01",
      "产量": 152.4,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.4
    },
    {
      "机号": "A09",
      "产量": 39,
      "积分": 1,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.4
    },
    {
      "机号": "A02",
      "产量": 161.8,
      "积分": 1,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.4
    },
    {
      "机号": "A02",
      "产量": 129.1,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.4
    },
    {
      "机号": "A09",
      "产量": 27,
      "积分": 0,
      "班次": "乙班",
      "排名": 4,
      "日期": 9.4
    },
    {
      "机号": "A04",
      "产量": 171.8,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A05",
      "产量": 170,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A03",
      "产量": 160.4,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A03",
      "产量": 158.8,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A02",
      "产量": 157.7,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A01",
      "产量": 156.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A02",
      "产量": 155,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A05",
      "产量": 151.7,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A04",
      "产量": 150.5,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A09",
      "产量": 47.6,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.5
    },
    {
      "机号": "A01",
      "产量": 154.5,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.5
    },
    {
      "机号": "A09",
      "产量": 34.2,
      "积分": 4,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.5
    },
    {
      "机号": "A09",
      "产量": 45,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.6
    },
    {
      "机号": "A09",
      "产量": 42.6,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.6
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A02",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A02",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.6
    },
    {
      "机号": "A09",
      "产量": 42.4,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.7
    },
    {
      "机号": "A09",
      "产量": 42.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.7
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A02",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A02",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A04",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A05",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.7
    },
    {
      "机号": "A05",
      "产量": 166,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.8
    },
    {
      "机号": "A05",
      "产量": 165,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.8
    },
    {
      "机号": "A01",
      "产量": 159.9,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.8
    },
    {
      "机号": "A01",
      "产量": 159.1,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.8
    },
    {
      "机号": "A02",
      "产量": 147.1,
      "积分": 1,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.8
    },
    {
      "机号": "A04",
      "产量": 146.6,
      "积分": 1,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.8
    },
    {
      "机号": "A02",
      "产量": 150.1,
      "积分": 0,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.8
    },
    {
      "机号": "A04",
      "产量": 136.2,
      "积分": 0,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.8
    },
    {
      "机号": "A09",
      "产量": 37,
      "积分": 0,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.8
    },
    {
      "机号": "A09",
      "产量": 38.8,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.8
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.8
    },
    {
      "机号": "A03",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.8
    },
    {
      "机号": "A05",
      "产量": 163.7,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A04",
      "产量": 160.1,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A03",
      "产量": 158,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A02",
      "产量": 157.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A04",
      "产量": 157,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A05",
      "产量": 156,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A03",
      "产量": 155.6,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.9
    },
    {
      "机号": "A02",
      "产量": 146.4,
      "积分": 4,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.9
    },
    {
      "机号": "A01",
      "产量": 156.8,
      "积分": 1,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.9
    },
    {
      "机号": "A01",
      "产量": 134,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.9
    },
    {
      "机号": "A09",
      "产量": 33.2,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.9
    },
    {
      "机号": "A09",
      "产量": 11.6,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.9
    },
    {
      "机号": "A03",
      "产量": 163.2,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A05",
      "产量": 162.6,
      "积分": 5,
      "班次": "甲班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A03",
      "产量": 159.2,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A05",
      "产量": 158.7,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A04",
      "产量": 157.5,
      "积分": 5,
      "班次": "乙班",
      "排名": 1,
      "日期": 9.1
    },
    {
      "机号": "A04",
      "产量": 151.2,
      "积分": 4,
      "班次": "甲班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A02",
      "产量": 146.1,
      "积分": 1,
      "班次": "乙班",
      "排名": 2,
      "日期": 9.1
    },
    {
      "机号": "A02",
      "产量": 119.6,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.1
    },
    {
      "机号": "A09",
      "产量": 38.2,
      "积分": 0,
      "班次": "乙班",
      "排名": 3,
      "日期": 9.1
    },
    {
      "机号": "A09",
      "产量": 32.4,
      "积分": 0,
      "班次": "甲班",
      "排名": 3,
      "日期": 9.1
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "甲班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A01",
      "产量": "/",
      "积分": "/",
      "班次": "乙班",
      "排名": "-",
      "日期": 9.1
    },
    {
      "机号": "A09",
      "产量": "生产牌号不符",
      "积分": "/",
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A09",
      "产量": "生产牌号不符",
      "积分": "/",
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A05",
      "产量": 172.3,
      "积分": 5,
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A04",
      "产量": 163.3,
      "积分": 5,
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A03",
      "产量": 161.8,
      "积分": 5,
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A03",
      "产量": 160.8,
      "积分": 5,
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A04",
      "产量": 156.3,
      "积分": 5,
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A05",
      "产量": 143.5,
      "积分": 5,
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A01",
      "产量": 158.5,
      "积分": 1,
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A02",
      "产量": 143.6,
      "积分": 1,
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A02",
      "产量": 149.1,
      "积分": 0,
      "班次": "甲班",
      "排名": NaN,
      "日期": 9.11
    },
    {
      "机号": "A01",
      "产量": 102.4,
      "积分": 0,
      "班次": "乙班",
      "排名": NaN,
      "日期": 9.11
    }
  ],
  "daily_scores": {
    "9.1": [
      {
        "机号": "A01",
        "甲班(中班)产量": 153.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 163.2,
        "乙班(早班)积分": 5,
        "总产量": 316.6,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(中班)产量": 127.4,
        "甲班(中班)积分": 0,
        "乙班(早班)产量": 112.4,
        "乙班(早班)积分": 0,
        "总产量": 239.8,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(中班)产量": 152.4,
        "甲班(中班)积分": 1,
        "乙班(早班)产量": 110.6,
        "乙班(早班)积分": 0,
        "总产量": 263,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A05",
        "甲班(中班)产量": 134.8,
        "甲班(中班)积分": 0,
        "乙班(早班)产量": 113.6,
        "乙班(早班)积分": 0,
        "总产量": 248.4,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      }
    ],
    "9.2": [
      {
        "机号": "A01",
        "甲班(中班)产量": 155.2,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 149.6,
        "乙班(早班)积分": 4,
        "总产量": 304.8,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(中班)产量": 130.4,
        "甲班(中班)积分": 0,
        "乙班(早班)产量": 151.8,
        "乙班(早班)积分": 0,
        "总产量": 282.2,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(中班)产量": 151.2,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 153.6,
        "乙班(早班)积分": 4,
        "总产量": 304.8,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(中班)产量": 150.9,
        "甲班(中班)积分": 1,
        "乙班(早班)产量": 145.6,
        "乙班(早班)积分": 0,
        "总产量": 296.5,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(中班)产量": 159.1,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 169.4,
        "乙班(早班)积分": 5,
        "总产量": 328.5,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 40.6,
        "甲班(中班)积分": 1,
        "乙班(早班)产量": 26.0,
        "乙班(早班)积分": 0,
        "总产量": 66.6,
        "台时不足": false
      }
    ],
    "9.3": [
      {
        "机号": "A01",
        "甲班(中班)产量": 157.6,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 152.6,
        "乙班(早班)积分": 4,
        "总产量": 310.2,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(中班)产量": 126.2,
        "甲班(中班)积分": 0,
        "乙班(早班)产量": 158.8,
        "乙班(早班)积分": 1,
        "总产量": 285,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(中班)产量": 152.6,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 164.6,
        "乙班(早班)积分": 5,
        "总产量": 317.2,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(中班)产量": 143.5,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 163.2,
        "乙班(早班)积分": 5,
        "总产量": 306.7,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 43.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 36.8,
        "乙班(早班)积分": 4,
        "总产量": 80.2,
        "台时不足": false
      }
    ],
    "9.4": [
      {
        "机号": "A01",
        "甲班(中班)产量": 147.9,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 152.4,
        "乙班(早班)积分": 4,
        "总产量": 300.3,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(中班)产量": 129.1,
        "甲班(中班)积分": 0,
        "乙班(早班)产量": 161.8,
        "乙班(早班)积分": 1,
        "总产量": 290.9,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(中班)产量": 154.0,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 163.4,
        "乙班(早班)积分": 5,
        "总产量": 317.4,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(中班)产量": 153.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 163.0,
        "乙班(早班)积分": 5,
        "总产量": 316.4,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(中班)产量": 162.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 170.2,
        "乙班(早班)积分": 5,
        "总产量": 332.6,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 39.0,
        "甲班(中班)积分": 1,
        "乙班(早班)产量": 27.0,
        "乙班(早班)积分": 0,
        "总产量": 66.0,
        "台时不足": false
      }
    ],
    "9.5": [
      {
        "机号": "A01",
        "甲班(中班)产量": 156.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 154.5,
        "乙班(早班)积分": 4,
        "总产量": 310.9,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(中班)产量": 155.0,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 157.7,
        "乙班(早班)积分": 5,
        "总产量": 312.7,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(中班)产量": 158.8,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 160.4,
        "乙班(早班)积分": 5,
        "总产量": 319.2,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(中班)产量": 150.5,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 171.8,
        "乙班(早班)积分": 5,
        "总产量": 322.3,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(中班)产量": 151.7,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 170.0,
        "乙班(早班)积分": 5,
        "总产量": 321.7,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 47.6,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 34.2,
        "乙班(早班)积分": 4,
        "总产量": 81.8,
        "台时不足": false
      }
    ],
    "9.6": [
      {
        "机号": "A01",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A02",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A03",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A04",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A05",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 42.6,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 45,
        "乙班(早班)积分": 5,
        "总产量": 87.6,
        "台时不足": false
      }
    ],
    "9.7": [
      {
        "机号": "A01",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A02",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A03",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A04",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A05",
        "甲班(中班)产量": "/",
        "甲班(中班)积分": "/",
        "乙班(早班)产量": "/",
        "乙班(早班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A09",
        "甲班(中班)产量": 42.4,
        "甲班(中班)积分": 5,
        "乙班(早班)产量": 42.2,
        "乙班(早班)积分": 5,
        "总产量": 84.6,
        "台时不足": false
      }
    ],
    "9.8": [
      {
        "机号": "A01",
        "甲班(早班)产量": 159.1,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 159.9,
        "乙班(中班)积分": 5,
        "总产量": 319,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(早班)产量": 150.1,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 147.1,
        "乙班(中班)积分": 1,
        "总产量": 297.2,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(早班)产量": "/",
        "甲班(早班)积分": "/",
        "乙班(中班)产量": "/",
        "乙班(中班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A04",
        "甲班(早班)产量": 136.2,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 146.6,
        "乙班(中班)积分": 1,
        "总产量": 282.8,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(早班)产量": 166,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 165,
        "乙班(中班)积分": 5,
        "总产量": 331,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(早班)产量": 37,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 38.8,
        "乙班(中班)积分": 0,
        "总产量": 75.8,
        "台时不足": false
      }
    ],
    "9.9": [
      {
        "机号": "A01",
        "甲班(早班)产量": 134.0,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 156.8,
        "乙班(中班)积分": 1,
        "总产量": 290.8,
        "台时不足": false
      },
      {
        "机号": "A02",
        "甲班(早班)产量": 146.4,
        "甲班(早班)积分": 4,
        "乙班(中班)产量": 157.2,
        "乙班(中班)积分": 5,
        "总产量": 303.6,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(早班)产量": 158.0,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 155.6,
        "乙班(中班)积分": 5,
        "总产量": 313.6,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(早班)产量": 160.1,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 157.0,
        "乙班(中班)积分": 5,
        "总产量": 317.1,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(早班)产量": 163.7,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 156.0,
        "乙班(中班)积分": 5,
        "总产量": 319.7,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(早班)产量": 11.6,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 33.2,
        "乙班(中班)积分": 0,
        "总产量": 44.8,
        "台时不足": false
      }
    ],
    "9.10": [
      {
        "机号": "A01",
        "甲班(早班)产量": "/",
        "甲班(早班)积分": "/",
        "乙班(中班)产量": "/",
        "乙班(中班)积分": "/",
        "总产量": "/",
        "台时不足": true
      },
      {
        "机号": "A02",
        "甲班(早班)产量": 119.6,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 146.1,
        "乙班(中班)积分": 1,
        "总产量": 265.7,
        "台时不足": false
      },
      {
        "机号": "A03",
        "甲班(早班)产量": 163.2,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 159.2,
        "乙班(中班)积分": 5,
        "总产量": 322.4,
        "台时不足": false
      },
      {
        "机号": "A04",
        "甲班(早班)产量": 151.2,
        "甲班(早班)积分": 4,
        "乙班(中班)产量": 157.5,
        "乙班(中班)积分": 5,
        "总产量": 308.7,
        "台时不足": false
      },
      {
        "机号": "A05",
        "甲班(早班)产量": 162.6,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 158.7,
        "乙班(中班)积分": 5,
        "总产量": 321.3,
        "台时不足": false
      },
      {
        "机号": "A09",
        "甲班(早班)产量": 32.4,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 38.2,
        "乙班(中班)积分": 0,
        "总产量": 70.6,
        "台时不足": false
      }
    ],
    "9.11": [
      {
        "机号": "A01",
        "甲班(早班)产量": 158.5,
        "甲班(早班)积分": 1,
        "乙班(中班)产量": 102.4,
        "乙班(中班)积分": 0,
        "总产量": 260.9,
        "台时不足": false,
        "生产牌号不符": NaN
      },
      {
        "机号": "A02",
        "甲班(早班)产量": 149.1,
        "甲班(早班)积分": 0,
        "乙班(中班)产量": 143.6,
        "乙班(中班)积分": 1,
        "总产量": 292.7,
        "台时不足": false,
        "生产牌号不符": NaN
      },
      {
        "机号": "A03",
        "甲班(早班)产量": 160.8,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 161.8,
        "乙班(中班)积分": 5,
        "总产量": 322.6,
        "台时不足": false,
        "生产牌号不符": NaN
      },
      {
        "机号": "A04",
        "甲班(早班)产量": 163.3,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 156.3,
        "乙班(中班)积分": 5,
        "总产量": 319.6,
        "台时不足": false,
        "生产牌号不符": NaN
      },
      {
        "机号": "A05",
        "甲班(早班)产量": 172.3,
        "甲班(早班)积分": 5,
        "乙班(中班)产量": 143.5,
        "乙班(中班)积分": 5,
        "总产量": 315.8,
        "台时不足": false,
        "生产牌号不符": NaN
      },
      {
        "机号": "A09",
        "甲班(早班)产量": "生产牌号不符",
        "甲班(早班)积分": "/",
        "乙班(中班)产量": "生产牌号不符",
        "乙班(中班)积分": "/",
        "总产量": "/",
        "台时不足": false,
        "生产牌号不符": 1.0
      }
    ]
  },
  "last_updated": "2025-09-12 12:14:23"
};</script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-trophy"></i> 杭烟卷包车间A线"聚力攻坚 提质达效"劳动竞赛</h1>
            <p>实时展示各机台竞赛排名和积分统计</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('total')">
                <i class="fas fa-medal"></i> 总分排名
            </button>
            <button class="tab" onclick="showTab('details')">
                <i class="fas fa-chart-bar"></i> 详细数据
            </button>
        </div>

        <div class="content">
            <!-- 总分排名 -->
            <div id="total-tab" class="tab-content">
                <h2 class="section-title">
                    <i class="fas fa-crown"></i> 总分排名
                </h2>
                <div class="ranking-table-container">
                    <table class="ranking-table" id="total-ranking-table">
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>机号</th>
                                <th>班次</th>
                                <th>总积分</th>
                                <th>有效天数</th>
                                <th>否样与批量追溯</th>
                                <th>日均产量</th>
                                <th>日均积分</th>
                            </tr>
                        </thead>
                        <tbody id="total-ranking-body">
                            <tr>
                                <td colspan="8" class="loading">加载中...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- 详细数据 -->
            <div id="details-tab" class="tab-content" style="display: none;">
                <h2 class="section-title">
                    <i class="fas fa-database"></i> 详细数据
                </h2>
                <div class="date-selector">
                    <div class="selector-group">
                        <label for="details-date-select">选择日期</label>
                        <select id="details-date-select" onchange="updateDetailsData()">
                            <option value="">请选择日期</option>
                        </select>
                    </div>
                    
                    <div class="selector-group">
                        <label for="machine-select">选择机台</label>
                        <select id="machine-select" onchange="updateMachineData()">
                            <option value="">请选择机台</option>
                            <optgroup label="甲班">
                                <option value="A01-甲班">A01</option>
                                <option value="A02-甲班">A02</option>
                                <option value="A03-甲班">A03</option>
                                <option value="A04-甲班">A04</option>
                                <option value="A05-甲班">A05</option>
                                <option value="A09-甲班">A09</option>
                            </optgroup>
                            <optgroup label="乙班">
                                <option value="A01-乙班">A01</option>
                                <option value="A02-乙班">A02</option>
                                <option value="A03-乙班">A03</option>
                                <option value="A04-乙班">A04</option>
                                <option value="A05-乙班">A05</option>
                                <option value="A09-乙班">A09</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="ranking-table-container">
                    <table class="ranking-table" id="details-table">
                        <thead>
                            <tr>
                                <th>机号</th>
                                <th>甲班(中班)产量</th>
                                <th>甲班(中班)积分</th>
                                <th>乙班(早班)产量</th>
                                <th>乙班(早班)积分</th>
                                <th>总产量</th>
                                <th>台时状态</th>
                            </tr>
                        </thead>
                        <tbody id="details-body">
                            <tr>
                                <td colspan="7" class="loading">请选择日期</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 机台历史数据表格 -->
                <div class="ranking-table-container" id="machine-history-container" style="display: none;">
                    <h3 style="margin: 20px 0 10px 0; color: #2c3e50;">机台历史数据</h3>
                    <table class="ranking-table" id="machine-history-table">
                        <thead>
                            <tr>
                                <th>日期</th>
                                <th>班次</th>
                                <th>产量</th>
                                <th>积分</th>
                                <th>台时状态</th>
                            </tr>
                        </thead>
                        <tbody id="machine-history-body">
                        </tbody>
                    </table>
                    <div id="machine-summary" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4 style="margin-bottom: 10px; color: #2c3e50;">统计汇总</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div><strong>总积分：</strong><span id="total-score">-</span></div>
                            <div><strong>有效天数：</strong><span id="valid-days">-</span></div>
                            <div><strong>日均产量：</strong><span id="avg-production">-</span></div>
                            <div><strong>日均积分：</strong><span id="avg-score">-</span></div>
                            <div><strong>当前排名：</strong><span id="current-ranking">-</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>数据更新时间：<span id="last-updated">-</span></p>
            <p>&copy; 2025 杭烟卷包车间A线"聚力攻坚 提质达效"劳动竞赛</p>
            <p>created by 胡明豪62344</p>
        </div>
    </div>

    <script>
        let competitionData = null;

        // 加载数据
        // loadData函数已移除，数据已嵌入到HTML中

        // 初始化页面
        function initializePage() {
            if (!competitionData) return;

            // 更新最后更新时间
            document.getElementById('last-updated').textContent = competitionData.last_updated;

            // 初始化总分排名
            updateTotalRanking();

            // 初始化日期选择器
            initializeDateSelectors();

            // 显示默认标签页
            showTab('total');
        }

        // 更新总分排名
        function updateTotalRanking() {
            if (!competitionData) return;

            const totalRankings = competitionData.total_rankings;
            const tbody = document.getElementById('total-ranking-body');
            
            // 清空表格
            tbody.innerHTML = '';

            // 按排名排序，不按班次分组
            const sortedRankings = totalRankings.sort((a, b) => a.排名 - b.排名);

            // 添加所有排名
            sortedRankings.forEach(ranking => {
                const row = createTotalRankingRow(ranking);
                tbody.appendChild(row);
            });

        }

        // 获取带图标的排名
        function getRankWithIcon(rank) {
            if (rank === 1) return '🏆 1';
            if (rank === 2) return '🥈 2';
            if (rank === 3) return '🥉 3';
            if (rank === 4) return '🥉 4';
            return rank;
        }

        // 创建总分排名行
        function createTotalRankingRow(ranking) {
            const row = document.createElement('tr');
            
            const rankClass = ranking.排名 <= 3 ? `rank-${ranking.排名}` : '';
            const scoreClass = getScoreClass(ranking.总积分);
            const rankWithIcon = getRankWithIcon(ranking.排名);
            
            // 计算否样与批量追溯信息
            const negativeCount = ranking.否样次数 || 0;
            const traceabilityText = negativeCount.toString();
            
            row.innerHTML = `
                <td class="${rankClass}">${rankWithIcon}</td>
                <td><strong>${ranking.机号}</strong></td>
                <td>${ranking.班次}</td>
                <td class="${scoreClass}">${ranking.总积分}</td>
                <td>${ranking.有效天数}</td>
                <td>${traceabilityText}</td>
                <td>${ranking.日均产量}</td>
                <td class="${scoreClass}">${ranking.日均积分}</td>
            `;
            
            return row;
        }


        // 初始化日期选择器
        function initializeDateSelectors() {
            if (!competitionData) return;

            // 自定义日期排序函数，处理"9.1", "9.2", "9.10"等格式
            const dates = Object.keys(competitionData.daily_scores).sort((a, b) => {
                const [monthA, dayA] = a.split('.').map(Number);
                const [monthB, dayB] = b.split('.').map(Number);
                
                // 先比较月份，再比较日期
                if (monthA !== monthB) {
                    return monthA - monthB;
                }
                return dayA - dayB;
            });
            const detailsDateSelect = document.getElementById('details-date-select');

            dates.forEach(date => {
                const option = document.createElement('option');
                option.value = date;
                option.textContent = date;
                detailsDateSelect.appendChild(option);
            });
        }


        // 更新详细数据
        function updateDetailsData() {
            if (!competitionData) return;

            const selectedDate = document.getElementById('details-date-select').value;
            const tbody = document.getElementById('details-body');
            
            // 隐藏机台历史数据并清空机台选择
            document.getElementById('machine-history-container').style.display = 'none';
            document.getElementById('machine-select').value = '';
            
            if (!selectedDate) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading">请选择日期</td></tr>';
                return;
            }

            const dailyScores = competitionData.daily_scores[selectedDate];
            
            tbody.innerHTML = '';
            
            // 动态获取列名
            const sample = dailyScores[0];
            const jiaProductionCol = Object.keys(sample).find(key => key.includes('甲班') && key.includes('产量'));
            const jiaScoreCol = Object.keys(sample).find(key => key.includes('甲班') && key.includes('积分'));
            const yiProductionCol = Object.keys(sample).find(key => key.includes('乙班') && key.includes('产量'));
            const yiScoreCol = Object.keys(sample).find(key => key.includes('乙班') && key.includes('积分'));
            
            // 更新表头
            const thead = document.querySelector('#details-table thead tr');
            thead.innerHTML = `
                <th>机号</th>
                <th>${jiaProductionCol}</th>
                <th>${jiaScoreCol}</th>
                <th>${yiProductionCol}</th>
                <th>${yiScoreCol}</th>
                <th>总产量</th>
                <th>台时状态</th>
            `;
            
            dailyScores.forEach(score => {
                const row = document.createElement('tr');
                
                const jiaScoreClass = score[jiaScoreCol] === '/' ? 'insufficient' : getScoreClass(parseInt(score[jiaScoreCol]) || 0);
                const yiScoreClass = score[yiScoreCol] === '/' ? 'insufficient' : getScoreClass(parseInt(score[yiScoreCol]) || 0);
                // 台时状态判断逻辑：优先检查生产牌号不符，然后检查台时不足
                let statusText = '正常';
                let statusClass = '';
                
                if (score.生产牌号不符) {
                    statusText = '生产牌号不符';
                    statusClass = 'insufficient';
                } else if (score.台时不足) {
                    statusText = '台时不足';
                    statusClass = 'insufficient';
                }
                
                row.innerHTML = `
                    <td><strong>${score.机号}</strong></td>
                    <td class="${score[jiaProductionCol] === '/' ? 'insufficient' : ''}">${score[jiaProductionCol]}</td>
                    <td class="${jiaScoreClass}">${score[jiaScoreCol]}</td>
                    <td class="${score[yiProductionCol] === '/' ? 'insufficient' : ''}">${score[yiProductionCol]}</td>
                    <td class="${yiScoreClass}">${score[yiScoreCol]}</td>
                    <td class="${score.总产量 === '/' ? 'insufficient' : ''}">${score.总产量}</td>
                    <td class="${statusClass}">${statusText}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // 更新机台历史数据
        function updateMachineData() {
            if (!competitionData) return;

            const selectedMachine = document.getElementById('machine-select').value;
            const historyContainer = document.getElementById('machine-history-container');
            const historyBody = document.getElementById('machine-history-body');
            
            if (!selectedMachine) {
                historyContainer.style.display = 'none';
                return;
            }

            // 解析选择的机台信息
            const [machineNumber, shift] = selectedMachine.split('-');
            
            // 显示机台历史数据容器
            historyContainer.style.display = 'block';
            
            // 清空表格
            historyBody.innerHTML = '';
            
            // 收集该机台的所有历史数据
            const machineHistory = [];
            let totalScore = 0;
            let totalProduction = 0;
            let validDays = 0;
            
            // 遍历所有日期的数据
            Object.keys(competitionData.daily_scores).forEach(date => {
                const dailyScores = competitionData.daily_scores[date];
                const machineData = dailyScores.find(data => data.机号 === machineNumber);
                
                if (machineData) {
                    // 根据班次获取对应的产量和积分
                    let production = 0;
                    let score = 0;
                    let status = '正常';
                    let actualShift = ''; // 当天的具体班次（早班或中班）
                    
                    if (shift === '甲班') {
                        const jiaProductionCol = Object.keys(machineData).find(key => key.includes('甲班') && key.includes('产量'));
                        const jiaScoreCol = Object.keys(machineData).find(key => key.includes('甲班') && key.includes('积分'));
                        
                        if (jiaProductionCol && jiaScoreCol) {
                            production = machineData[jiaProductionCol];
                            score = machineData[jiaScoreCol];
                            
                            // 从列名中提取具体班次信息
                            if (jiaProductionCol.includes('早班')) {
                                actualShift = '早班';
                            } else if (jiaProductionCol.includes('中班')) {
                                actualShift = '中班';
                            } else {
                                actualShift = '甲班'; // 默认显示
                            }
                        }
                    } else {
                        const yiProductionCol = Object.keys(machineData).find(key => key.includes('乙班') && key.includes('产量'));
                        const yiScoreCol = Object.keys(machineData).find(key => key.includes('乙班') && key.includes('积分'));
                        
                        if (yiProductionCol && yiScoreCol) {
                            production = machineData[yiProductionCol];
                            score = machineData[yiScoreCol];
                            
                            // 从列名中提取具体班次信息
                            if (yiProductionCol.includes('早班')) {
                                actualShift = '早班';
                            } else if (yiProductionCol.includes('中班')) {
                                actualShift = '中班';
                            } else {
                                actualShift = '乙班'; // 默认显示
                            }
                        }
                    }
                    
                    // 判断台时状态
                    if (machineData.生产牌号不符) {
                        status = '生产牌号不符';
                    } else if (machineData.台时不足) {
                        status = '台时不足';
                    } else if (production === '/' || production === null || production === undefined || production === '') {
                        status = '台时不足';
                    } else if (typeof production === 'string' && production !== '/') {
                        status = production; // 显示原始字符串
                    }
                    
                    // 只统计有效数据（数值类型）
                    const isValidNumber = !isNaN(parseFloat(production)) && !isNaN(parseFloat(score));
                    if (isValidNumber) {
                        totalScore += parseFloat(score);
                        totalProduction += parseFloat(production);
                        validDays++;
                    }
                    
                    machineHistory.push({
                        date: date,
                        shift: actualShift,
                        production: production,
                        score: score,
                        status: status,
                        isValid: isValidNumber
                    });
                }
            });
            
            // 按日期排序
            machineHistory.sort((a, b) => {
                const [monthA, dayA] = a.date.split('.').map(Number);
                const [monthB, dayB] = b.date.split('.').map(Number);
                if (monthA !== monthB) return monthA - monthB;
                return dayA - dayB;
            });
            
            // 填充表格
            machineHistory.forEach(data => {
                const row = document.createElement('tr');
                const productionClass = data.isValid ? '' : 'insufficient';
                const scoreClass = data.isValid ? getScoreClass(parseFloat(data.score)) : 'insufficient';
                const statusClass = data.status === '正常' ? '' : 'insufficient';
                
                row.innerHTML = `
                    <td>${data.date}</td>
                    <td>${data.shift}</td>
                    <td class="${productionClass}">${data.production}</td>
                    <td class="${scoreClass}">${data.score}</td>
                    <td class="${statusClass}">${data.status}</td>
                `;
                
                historyBody.appendChild(row);
            });
            
            // 更新统计汇总
            const avgProduction = validDays > 0 ? (totalProduction / validDays).toFixed(1) : 0;
            const avgScore = validDays > 0 ? (totalScore / validDays).toFixed(2) : 0;
            
            document.getElementById('total-score').textContent = totalScore;
            document.getElementById('valid-days').textContent = validDays;
            document.getElementById('avg-production').textContent = avgProduction;
            document.getElementById('avg-score').textContent = avgScore;
            
            // 获取当前排名
            const totalRankings = competitionData.total_rankings;
            const currentRanking = totalRankings.find(ranking => 
                ranking.机号 === machineNumber && ranking.班次 === shift
            );
            document.getElementById('current-ranking').textContent = currentRanking ? currentRanking.排名 : '-';
        }

        // 获取积分样式类
        function getScoreClass(score) {
            if (score >= 5) return 'score-high';
            if (score >= 3) return 'score-medium';
            if (score > 0) return 'score-low';
            return '';
        }

        // 显示标签页
        function showTab(tabName) {
            // 隐藏所有标签页
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // 移除所有标签的active类
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 显示选中的标签页
            document.getElementById(tabName + '-tab').style.display = 'block';
            
            // 添加active类到选中的标签
            event.target.classList.add('active');
        }

        // 显示错误信息
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            document.querySelector('.content').insertBefore(errorDiv, document.querySelector('.content').firstChild);
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            if (window.competitionData) {
                competitionData = window.competitionData;
                initializePage();
            } else {
                showError('数据加载失败');
            }
        });
    </script>
</body>
</html>
